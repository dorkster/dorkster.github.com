<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>dorkster - Blog</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="main.css" rel="stylesheet" type="text/css" title="main"/>
</head>

<body>

<h1>dorkster</h1>
<ul class="navigation">
    <li><a href="index.html">Blog</a></li>
    <li><a href="projects.html">Projects</a></li>
    <li><a href="about.html">About</a></li>
</ul>
<hr/>

<div class="content">

<div class="blogpost">
<h2>2014/12/09 10:02:52</h2>

<p><img src="images/nomans_dungeon.png" alt="Noman's Dungeon Screenshot" title="" /></p>

<p>This past weekend, I participated in my first Ludum Dare. In preparation, I had put together a simple framework of an engine using SDL 2. The framework provided simple things, like easily loading and using static images, animations, and sounds. The jam itself was quite a challenge, but it was also a lot of fun.</p>

<p>The game, entitled "Noman's Dungeon", is up <a href="http://ludumdare.com/compo/ludum-dare-31/?action=preview&amp;uid=44489">here on the Ludum Dare website</a>. I've also put together a time-lapse video of the entire development process, which you can <a href="https://www.youtube.com/watch?v=KXeY-RI3xIU">watch here on Youtube</a>. What I'd like to do now is give a post-mortem on how the whole thing went.</p>

<p>I initially spent the first hour brainstorming ideas that fit with the "entire game on one screen" theme. After tossing around some ideas like a 1v1 tank battle game and a puzzle/platformer like Solomon's Key, I settled on a turn-based rogue-like. I had thought of such a game in the past, so this felt like a good opportunity to try it out. Here is the outline I ended up with:</p>

<ul>
<li>super-simple turn based rpg, srpg combat like Disgaea</li>
<li>rogue-like; get "orb" at the end and return to the surface; permadeath;</li>
<li>some rooms have enemies, some have treasures; only 1 room at a time (keep it on one screen)</li>
<li>make battles tough, but give the option to run. Running means that you'll need to fight a stronger version of the enemy on the way back</li>
<li>Items: swords (high dmg, low range), bows (low dmg, high range), armor, health potions; start with basic sword and bow</li>
<li>Enemies: slimes (low range, high damage), archer skeleton (high range, low damage), goblin boss (high range, high damage)</li>
<li>some tiles are trapped. Can be both positive and negative (hp restore, spike trap that does damage)</li>
</ul>

<p>This outline felt doable in the 48 competition time frame. So how did it go?</p>

<h3>What went right</h3>

<ul>
<li>The art style. The comments I have received so far have been very positive about the artwork. I had not decided on the art style until around the end of the first day. At that point, I was feeling ready to start replacing the placeholder art. I had remembered a bullet point from the great <a href="https://www.youtube.com/watch?v=Fy0aCDmgnxg">Juice it or lose it</a> talk: add eyes to things. I added some eyes to the slime monster, and everything snowballed from there.</li>
<li>The turn-based system came out to be what I had originally envisioned.</li>
<li>I succeeded in creating the win goal. The progression worked well: fight your way to the last floor, get the treasure, fight your way back to the top. The fight back to the top spawns more enemies than on the way down for increased challenge.</li>
<li>I believe I stuck to the theme well enough. Even though the player is moving through randomly generated rooms, all of them are ultimately the same rectangular room.</li>
<li>Something that almost didn't make it in time were the rocks and crates that litter each room. They add a much needed variety to each level.</li>
<li>Using the framework I had already created saved a lot of potential headaches (with a few exceptions I'll explain later).</li>
<li>My work pace throughout the weekend was pretty much on point. Where this was my first Ludum Dare, I was worried I wouldn't have a functional game by the end.</li>
<li>The game's actually a little fun. Can't ask for much more than that.</li>
</ul>

<h3>What went wrong</h3>

<ul>
<li>While my framework saved me some time, there were a few bugs that popped up. Most notably was that my image reference counts were incorrect when used in animations. I actually needed to fix that one twice, since my initial fix wasn't complete. Fixing those bugs ate more time than I should have spent on such things.</li>
<li>The game is too easy, so there's no benefit to running. The game was initially way too difficult, but I over-corrected in the opposite direction. I simply didn't have enough time to play with balancing the combat numbers. However, it's possible that making the game easy was the right choice, since it meant more people could see the whole game. To me, that's better than the players dying a bunch and getting frustrated.</li>
<li>No enemy variety. Although they have slightly randomized stats, it is just slimes for the whole game. That's only 1/3 of the enemy types I had originally planned.</li>
<li>No bows. It would have been nice to have an alternative attack method, perhaps with finite ammunition.</li>
<li>While not very important, there were no traps. That would have been something interesting for the player to encounter and would have added variety.</li>
<li>I feel that having the player (and slimes) only move 1 tile per turn doesn't provide a lot of tactical options.</li>
<li>I could only provide Linux and Windows builds. Although it should be relatively easy to build on Mac OS X, it would have been nice to be able to provide a pre-built package for those people. Something I'd like to do in the future (not for a game jam) is create a web version of the game, so anyone with a modern web browser could play. I've never done any HTML canvas and Javascript in the context of a game, so I'll probably be looking at Clint Bellanger's <a href="http://heroinedusk.com/">Heroine Dusk</a> as a way of learning.</li>
<li>While not something that's important in the context of a game jam, some of my code's structure is a bit poor. I ended up putting a lot of the game's logic in the MapEngine class, where it didn't really belong. Sorting out that structure is something I want to do before working on a port to another language.</li>
<li>During the process, I want to make it so that entities "tweened" when moving between positions, but my movement system made that too difficult to implement in a reasonable amount of time.</li>
</ul>

<p>So where do I go from here? I have a fun little game that's begging for some balancing and some more content. A lot of the things myself and others found to be problems with the game are simply results of having a limited amount of time. I think it's something that I want to continue working on, even though the jam is over. Maybe it will turn into something really cool one day.</p>
<p><a href="blog_2014-12-09_10-02-52.html">Permalink</a></p>
</div>
<div class="blogpost">
<h2>2014/10/10 14:53:17</h2>

<p>The past month or so has been pretty good for Flare development. Many crashes, memory leaks, and bugs were reported and fixed. Many of the bugs revolved around poor handling of items, which was causing items to disappear in some cases. The crashes were mostly just us not respecting array bounds, and were introduced fairly recently. The memory leaks, on the other hand, turned out to be long-standing problems. Who knew that every instance of WidgetLabel (most places where there is text) was leaking memory?</p>

<p>The other major memory leak was known for a long time, so I feel like going into a bit of detail. Map events have the ability to cast powers (e.g. the trapped chests in the Brothers' Lair). In order to cast these powers, we were creating a StatBlock that was attached to the event. The problem was that the event could be deleted while the power was still active, resulting in the StatBlock leaking. The solution was to determine ahead of time which events will need StatBlocks, and allocate them in an array attached to the Map class itself.</p>

<p>It hasn't all been scrambling to fix stuff, though. We've also had time to work on some new features. The loot system got a bit of reworking, so it is now possible to define loot tables in separate files instead of having to define loot inline. This is handy because we can re-use loot tables in multiple places. The best part is that we can mix these loot files with inline loot definitions to add lots of variety.</p>

<p>Also related to loot, we've added the ability for powers to drop loot. One of the more interesting ideas that was tossed around was the idea of a thief class that can punch the gold out of enemies. Clint also pointed out that powers that require an item and drop a different item is a simple version of crafting.</p>

<p>Igor has been very helpful in continuing work on the Android port. A lot of the work here involved re-thinking input to work with touchscreens. Many things we take for granted when using a mouse, like hovering over icons to see tooltips, had to be changed. Our solution for that case was to display tooltips on the first tap, followed by the regular "left-click" action on the second tap. During this whole process, we were even able to improve some things on the mouse/keyboard side of things, like <a href="http://a.pomf.se/ultkao.webm">being able to pick a target for some powers after activating from the action bar</a>.</p>

<p>Finally, we merged the SDL hardware renderer from flare-engine-next into upstream flare-engine. Aside from <a href="https://github.com/dorkster/flare-engine-next/issues/5#issuecomment-58497417">one minor issue</a>, it looks identical to the software renderer. Of course, it is much faster than the software renderer because GPUs are just better equipped for handling graphics (go figure). Since this feature is upstream now, <strong>I hard reset the flare-engine-next repo to upstream</strong>, so please update your forks and local clones appropriately.</p>
<p><a href="blog_2014-10-10_14-53-17.html">Permalink</a></p>
</div>
<div class="blogpost">
<h2>2014/08/11 20:30:41</h2>

<p>In my last post, I mentioned the plan for a developer menu for Flare. I created <a href="https://www.youtube.com/watch?v=ZhLAPOs5pT8&amp;list=UUkvFvU2eOTKylDAZOJkHfRw">an implementation of my idea</a>, but it wasn't very flexible when it came to adding functionality. It also added more than an acceptable amount of code to the MenuManager class (which is already messy). As an alternative, I started working on a <a href="https://www.youtube.com/watch?v=hLlzxaZW8Iw&amp;list=UUkvFvU2eOTKylDAZOJkHfRw">developer console</a>.</p>

<p><img src="images/devconsole.png" alt="developer console screenshot" title="" /></p>

<p>The end result is something that has more functionality, like being able to specify level range for "spawn_enemy". In addition, the majority of code for the developer menu resides in the MenuDevConsole class itself, as opposed to MenuManager.</p>

<p>I don't regret spending time on the original developer menu. During the process, I ended up looking at my 2-year-old code for WidgetListBox, which was overall poor in quality. I'm also glad that things shifted towards a developer console, since it got me to look at how to draw text items in a WidgetScrollBox. I was able to refactor out the code from MenuLog into a new WidgetLog class, which is then used in MenuLog and MenuDevConsole. Implementing new features isn't just stacking blocks on top of each other. It sometimes forces you to take a step back and look at the base of what you've built.</p>

<p>Moving on, I also spent a bit of time <a href="https://github.com/clintbellanger/flare-engine/pull/1140">trying to improve how targeting enemies works</a>. It's a common complaint we've been getting, and it's usually due to the fact that melee attacks are using aim<em>assist. In the context of Flare, aim</em>assist is used to target attacks on the ground (where the enemy hitbox actually is) when aiming at the chest of a human-sized enemy. This works for projectile attacks, since it makes the projectile fly directly through the cursor. In order to get a better idea of what was happening with targeting, I made it so that a "target" animation is drawn on the ground where the target actually is. Having such an animation makes combat feel much more solid, since it's more clear where attacks are actually landing.</p>

<p>The next order of business was to sort out melee attacks. Turning off aim_assist for these attacks made them work as expected with short enemies, like antlion hatchlings and goblins. However, there was still the issue of trying to attack larger enemies. If the player clicked on the head of a zombie, their attack would land above the zombie's hitbox. The solution I came up with was to implement some auto-aim for melee attacks. We already determine the enemy under the mouse cursor for MenuEnemy, so we can use the position of that enemy as the target of the melee attack.</p>

<p>Well, enough about Flare. I was somehow able to find time to fix an FFmpeg crash I had encountered. After updating FFmpeg from 1:2.2.5 to 1:2.3.1, SpaceFM was crashing when generating thumbnails for my episodes of Nichijou. The crash was happening because a bit of new code was trying to read Matroska chapter data even if the chapter data wasn't created (in my case, due to a broken chapter in the last episode). So a simple NULL-check did the trick. I'm now just waiting for <a href="files/ffmpeg-patch.patch">the patch</a> to get reviewed on the ffmpeg-devel mailing list.</p>

<p>EDIT: Turns out my patch was <a href="http://git.videolan.org/?p=ffmpeg.git;a=commit;h=87dc8b3af9135f0cfcdf3c0520e3f29e7b0d92c6">merged 3 days prior to this post</a>, and I didn't notice since my tiny brain couldn't handle the concept of a mailing list.</p>
<p><a href="blog_2014-08-11_20-30-41.html">Permalink</a></p>
</div>
<div class="blogpost">
<h2>2014/08/01 19:32:05</h2>

<p>I've been a little inactive for the past week. I lost my internet connection for a few days, so I got into playing some single-player games in my free time instead of working. However, I think I'm ready to get back into the swing of things. Today, I <a href="https://github.com/clintbellanger/flare-engine/issues/1134">outlined my idea</a> for a developer menu to add to Flare. I think it will make creating and iterating on the Empyrean campaign easier once it's implemented.</p>
<p><a href="blog_2014-08-01_19-32-05.html">Permalink</a></p>
</div>
<div class="blogpost">
<h2>2014/07/22 20:13:48</h2>

<p>So Clint filled me in on his plans for the Empyrean campaign. I now have a better grasp on the theme of each map along the path of the main path, so my map concepts should start to fit more closely with the storyline. Today's map is the Book of the Dead, a simple chamber that appears early on, but isn't fully used until later in the game.</p>

<p><a href="images/botd_alpha.jpg"><img src="images/thumb_botd_alpha.jpg" alt="book of the dead alpha" title="" /></a></p>
<p><a href="blog_2014-07-22_20-13-48.html">Permalink</a></p>
</div>
<p>
<a href="blog_page1.html">Older entries</a>
</p>

</div>

<hr/>
<p>
©2013-2014 Justin Jacobs.<br/>
This page uses valid <a href="http://jigsaw.w3.org/css-validator/check/referer">CSS 2.1</a> and <a href="http://validator.w3.org/check?uri=referer">XHTML 1.0 Strict</a>.
</p>

</body>

</html>
