<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>dorkster - Blog</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="main.css" rel="stylesheet" type="text/css" title="main"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:site" content="@jajdorkster"/>
<meta name="twitter:title" content="dorkster - Blog"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:image" content=""/>
</head>

<body>

<div class="navigation">
<h1>dorkster</h1>
<ul>
<li><a href="index.html">About</a></li>
<li><a class="current" href="blog_page0.html">Latest Blog Posts</a></li>
<li><a href="blog_archive.html">Blog Archive</a></li>
</ul>
</div>

<div class="content">
<hr class="header-hr"/>

<div class="blogpost">
<h2>2015/03/10 15:38:09</h2>

<p>Things have been interesting for the passed few weeks. The majority of my programming activity outside of FLARE boils down to personal pet projects. Sure, I distribute the source code under free licenses, but I never actually intend for other people to use any of my stuff.</p>

<h3>Freeblocks</h3>

<p><img src="images/freeblocks_v0.5.png" alt="Freeblocks v0.5" title="" /></p>

<p><a href="https://github.com/dorkster/freeblocks">Freeblocks</a> is one of those projects. I hacked it together for the <strong>One Game A Month</strong> game jam in January of 2013. At the time, I had a little bit of game dev experience under my belt from my contributions on FLARE. Looking back, however, I can see that I was still very inexperienced. So as with most pet projects, I put it on the shelf and left it there.</p>

<p>Fast-forward 2 years to February of this year, and I receive a pull request for a port to the <a href="http://www.gcw-zero.com/">GCW-Zero</a> by Github user cxong. The port was rough at first, but cxong and myself have spent the past month and a half improving the game. The improvements didn't stop at getting the GCW-Zero port working either. Some other milestones include a separate "jewels" game mode, control re-mapping support, and inclusion in the FreeBSD ports collection. At this time, <a href="https://github.com/dorkster/freeblocks/releases/tag/v0.5">version 0.5</a> is the current released version.</p>

<h3>SpaceFM</h3>

<p>Last June, I wanted to implement video thumbnails into the <a href="https://github.com/IgnorantGuru/spacefm">SpaceFM file manager</a>. So I <a href="http://dorkster.github.io/blog_2014-06-24_15-43-54.html">did just that</a>. However, IgnorantGuru had announced his hiatus a few months before, so it looked like SpaceFM would go unmaintained. I kept my changes on my own fork as a result. IgnorantGuru has since returned and contacted my about my video thumbnail code. I'm happy to say that it's upstream now and on it's way into SpaceFM 1.0!</p>

<h3>Dunst</h3>

<p><a href="https://github.com/knopwob/dunst">Dunst</a> is a super lightweight notification daemon I found. I started tinkering with it, since I wanted to add the ability to activate the default action by middle-clicking on a notification. In the process, I discovered a handful of memory leaks that I patched and got sent upstream. It's not much, but it still feels good to have more contributions in the <em>things-that-aren't-mine</em> bin.</p>

<h3>FLARE</h3>

<p>All this work on other projects has stolen some of my attention from FLARE recently. That isn't to say it's been completely neglected. On the engine side, a lot of small bugs have been fixed, including a <a href="https://github.com/clintbellanger/flare-engine/issues/1360">nasty crash</a> related to using both transformations and summons. In addition, Igor has put together the MapSaver API, which can be used in external programs that want to use FLARE's data structures for outputting maps. The <a href="https://github.com/Paul-Wortmann/Random_Map_Generator">Random Map Generator</a> is an example use of this. There are a few things I have on my mind that I want to implement before going to 1.0, but the engine is in a really good state now.</p>

<p>As for the actual game part, development of the Empyrean campaign has been slow. I was last working on "area 2", which contains three maps: a swamp area, a graveyard, and a ruined town as the entrance to the first dungeon. I'm happy with the swamp map that I created (see below). However, the graveyard map is not looking good to me as of now. I need to spend more time experimenting with it.</p>

<p><a href="images/merrimead_swamp.jpg"><img src="images/thumb_merrimead_swamp.jpg" alt="Merrimead Swamp" title="" /></a></p>

<p>The Empyrean campaign is going to require some rethinking in terms of gameplay. Things like the types of powers available to the player, power cooldowns, the amount of stat points per level, etc. I've been brainstorming ideas about all of these, and I'll probably start experimenting once the maps for the first dungeon are complete. That will be a good vertical slice to test things with.</p>

<p>When the engine and Empyrean campaign stuff starts coming together, I'd like to put together another FLARE developer log, since it's been quite a while since the last one. The reason I'm putting it off until more Empyrean stuff is complete is because I want some new stuff to show when demoing the engine features. Sure, I could show most things with the existing alpha_demo mod, but it's more exciting to see something new.</p>

<p>Now I just need to pull myself away from maintaining Freeblocks and playing Torchlight II.</p>
<p><a href="blog_2015-03-10_15-38-09.html">Permalink</a></p>
</div>
<div class="blogpost">
<h2>2014/12/09 10:02:52</h2>

<p><img src="images/nomans_dungeon.png" alt="Noman's Dungeon Screenshot" title="" /></p>

<p>This past weekend, I participated in my first Ludum Dare. In preparation, I had put together a simple framework of an engine using SDL 2. The framework provided simple things, like easily loading and using static images, animations, and sounds. The jam itself was quite a challenge, but it was also a lot of fun.</p>

<p>The game, entitled "Noman's Dungeon", is up <a href="http://ludumdare.com/compo/ludum-dare-31/?action=preview&amp;uid=44489">here on the Ludum Dare website</a>. I've also put together a time-lapse video of the entire development process, which you can <a href="https://www.youtube.com/watch?v=KXeY-RI3xIU">watch here on Youtube</a>. What I'd like to do now is give a postmortem on how the whole thing went.</p>

<p>I initially spent the first hour brainstorming ideas that fit with the "entire game on one screen" theme. After tossing around some ideas like a 1v1 tank battle game and a puzzle/platformer like Solomon's Key, I settled on a turn-based rogue-like. I had thought of such a game in the past, so this felt like a good opportunity to try it out. Here is the outline I ended up with:</p>

<ul>
<li>super-simple turn based rpg, srpg combat like Disgaea</li>
<li>rogue-like; get "orb" at the end and return to the surface; permadeath;</li>
<li>some rooms have enemies, some have treasures; only 1 room at a time (keep it on one screen)</li>
<li>make battles tough, but give the option to run. Running means that you'll need to fight a stronger version of the enemy on the way back</li>
<li>Items: swords (high dmg, low range), bows (low dmg, high range), armor, health potions; start with basic sword and bow</li>
<li>Enemies: slimes (low range, high damage), archer skeleton (high range, low damage), goblin boss (high range, high damage)</li>
<li>some tiles are trapped. Can be both positive and negative (hp restore, spike trap that does damage)</li>
</ul>

<p>This outline felt doable in the 48 competition time frame. So how did it go?</p>

<h3>What went right</h3>

<ul>
<li>The art style. The comments I have received so far have been very positive about the artwork. I had not decided on the art style until around the end of the first day. At that point, I was feeling ready to start replacing the placeholder art. I had remembered a bullet point from the great <a href="https://www.youtube.com/watch?v=Fy0aCDmgnxg">Juice it or lose it</a> talk: add eyes to things. I added some eyes to the slime monster, and everything snowballed from there.</li>
<li>The turn-based system came out to be what I had originally envisioned.</li>
<li>I succeeded in creating the win goal. The progression worked well: fight your way to the last floor, get the treasure, fight your way back to the top. The fight back to the top spawns more enemies than on the way down for increased challenge.</li>
<li>I believe I stuck to the theme well enough. Even though the player is moving through randomly generated rooms, all of them are ultimately the same rectangular room.</li>
<li>Something that almost didn't make it in time were the rocks and crates that litter each room. They add a much needed variety to each level.</li>
<li>Using the framework I had already created saved a lot of potential headaches (with a few exceptions I'll explain later).</li>
<li>My work pace throughout the weekend was pretty much on point. Where this was my first Ludum Dare, I was worried I wouldn't have a functional game by the end.</li>
<li>The game's actually a little fun. Can't ask for much more than that.</li>
</ul>

<h3>What went wrong</h3>

<ul>
<li>While my framework saved me some time, there were a few bugs that popped up. Most notably was that my image reference counts were incorrect when used in animations. I actually needed to fix that one twice, since my initial fix wasn't complete. Fixing those bugs ate more time than I should have spent on such things.</li>
<li>The game is too easy, so there's no benefit to running. The game was initially way too difficult, but I over-corrected in the opposite direction. I simply didn't have enough time to play with balancing the combat numbers. However, it's possible that making the game easy was the right choice, since it meant more people could see the whole game. To me, that's better than the players dying a bunch and getting frustrated.</li>
<li>No enemy variety. Although they have slightly randomized stats, it is just slimes for the whole game. That's only 1/3 of the enemy types I had originally planned.</li>
<li>No bows. It would have been nice to have an alternative attack method, perhaps with finite ammunition.</li>
<li>While not very important, there were no traps. That would have been something interesting for the player to encounter and would have added variety.</li>
<li>I feel that having the player (and slimes) only move 1 tile per turn doesn't provide a lot of tactical options.</li>
<li>I could only provide Linux and Windows builds. Although it should be relatively easy to build on Mac OS X, it would have been nice to be able to provide a pre-built package for those people. Something I'd like to do in the future (not for a game jam) is create a web version of the game, so anyone with a modern web browser could play. I've never done any HTML canvas and Javascript in the context of a game, so I'll probably be looking at Clint Bellanger's <a href="http://heroinedusk.com/">Heroine Dusk</a> as a way of learning.</li>
<li>While not something that's important in the context of a game jam, some of my code's structure is a bit poor. I ended up putting a lot of the game's logic in the MapEngine class, where it didn't really belong. Sorting out that structure is something I want to do before working on a port to another language.</li>
<li>During the process, I wanted to make it so that entities "tweened" when moving between positions, but my movement system made that too difficult to implement in a reasonable amount of time.</li>
</ul>

<p>So where do I go from here? I have a fun little game that's begging for some balancing and some more content. A lot of the things myself and others found to be problems with the game are simply results of having a limited amount of time. I think it's something that I want to continue working on, even though the jam is over. Maybe it will turn into something really cool one day.</p>
<p><a href="blog_2014-12-09_10-02-52.html">Permalink</a></p>
</div>
<div class="blogpost">
<h2>2014/10/10 14:53:17</h2>

<p>The past month or so has been pretty good for Flare development. Many crashes, memory leaks, and bugs were reported and fixed. Many of the bugs revolved around poor handling of items, which was causing items to disappear in some cases. The crashes were mostly just us not respecting array bounds, and were introduced fairly recently. The memory leaks, on the other hand, turned out to be long-standing problems. Who knew that every instance of WidgetLabel (most places where there is text) was leaking memory?</p>

<p>The other major memory leak was known for a long time, so I feel like going into a bit of detail. Map events have the ability to cast powers (e.g. the trapped chests in the Brothers' Lair). In order to cast these powers, we were creating a StatBlock that was attached to the event. The problem was that the event could be deleted while the power was still active, resulting in the StatBlock leaking. The solution was to determine ahead of time which events will need StatBlocks, and allocate them in an array attached to the Map class itself.</p>

<p>It hasn't all been scrambling to fix stuff, though. We've also had time to work on some new features. The loot system got a bit of reworking, so it is now possible to define loot tables in separate files instead of having to define loot inline. This is handy because we can re-use loot tables in multiple places. The best part is that we can mix these loot files with inline loot definitions to add lots of variety.</p>

<p>Also related to loot, we've added the ability for powers to drop loot. One of the more interesting ideas that was tossed around was the idea of a thief class that can punch the gold out of enemies. Clint also pointed out that powers that require an item and drop a different item is a simple version of crafting.</p>

<p>Igor has been very helpful in continuing work on the Android port. A lot of the work here involved re-thinking input to work with touchscreens. Many things we take for granted when using a mouse, like hovering over icons to see tooltips, had to be changed. Our solution for that case was to display tooltips on the first tap, followed by the regular "left-click" action on the second tap. During this whole process, we were even able to improve some things on the mouse/keyboard side of things, like <a href="http://a.pomf.se/ultkao.webm">being able to pick a target for some powers after activating from the action bar</a>.</p>

<p>Finally, we merged the SDL hardware renderer from flare-engine-next into upstream flare-engine. Aside from <a href="https://github.com/dorkster/flare-engine-next/issues/5#issuecomment-58497417">one minor issue</a>, it looks identical to the software renderer. Of course, it is much faster than the software renderer because GPUs are just better equipped for handling graphics (go figure). Since this feature is upstream now, <strong>I hard reset the flare-engine-next repo to upstream</strong>, so please update your forks and local clones appropriately.</p>
<p><a href="blog_2014-10-10_14-53-17.html">Permalink</a></p>
</div>
<div class="blogpost">
<h2>2014/08/11 20:30:41</h2>

<p>In my last post, I mentioned the plan for a developer menu for Flare. I created <a href="https://www.youtube.com/watch?v=ZhLAPOs5pT8&amp;list=UUkvFvU2eOTKylDAZOJkHfRw">an implementation of my idea</a>, but it wasn't very flexible when it came to adding functionality. It also added more than an acceptable amount of code to the MenuManager class (which is already messy). As an alternative, I started working on a <a href="https://www.youtube.com/watch?v=hLlzxaZW8Iw&amp;list=UUkvFvU2eOTKylDAZOJkHfRw">developer console</a>.</p>

<p><img src="images/devconsole.png" alt="developer console screenshot" title="" /></p>

<p>The end result is something that has more functionality, like being able to specify level range for "spawn_enemy". In addition, the majority of code for the developer menu resides in the MenuDevConsole class itself, as opposed to MenuManager.</p>

<p>I don't regret spending time on the original developer menu. During the process, I ended up looking at my 2-year-old code for WidgetListBox, which was overall poor in quality. I'm also glad that things shifted towards a developer console, since it got me to look at how to draw text items in a WidgetScrollBox. I was able to refactor out the code from MenuLog into a new WidgetLog class, which is then used in MenuLog and MenuDevConsole. Implementing new features isn't just stacking blocks on top of each other. It sometimes forces you to take a step back and look at the base of what you've built.</p>

<p>Moving on, I also spent a bit of time <a href="https://github.com/clintbellanger/flare-engine/pull/1140">trying to improve how targeting enemies works</a>. It's a common complaint we've been getting, and it's usually due to the fact that melee attacks are using aim<em>assist. In the context of Flare, aim</em>assist is used to target attacks on the ground (where the enemy hitbox actually is) when aiming at the chest of a human-sized enemy. This works for projectile attacks, since it makes the projectile fly directly through the cursor. In order to get a better idea of what was happening with targeting, I made it so that a "target" animation is drawn on the ground where the target actually is. Having such an animation makes combat feel much more solid, since it's more clear where attacks are actually landing.</p>

<p>The next order of business was to sort out melee attacks. Turning off aim_assist for these attacks made them work as expected with short enemies, like antlion hatchlings and goblins. However, there was still the issue of trying to attack larger enemies. If the player clicked on the head of a zombie, their attack would land above the zombie's hitbox. The solution I came up with was to implement some auto-aim for melee attacks. We already determine the enemy under the mouse cursor for MenuEnemy, so we can use the position of that enemy as the target of the melee attack.</p>

<p>Well, enough about Flare. I was somehow able to find time to fix an FFmpeg crash I had encountered. After updating FFmpeg from 1:2.2.5 to 1:2.3.1, SpaceFM was crashing when generating thumbnails for my episodes of Nichijou. The crash was happening because a bit of new code was trying to read Matroska chapter data even if the chapter data wasn't created (in my case, due to a broken chapter in the last episode). So a simple NULL-check did the trick. I'm now just waiting for <a href="files/ffmpeg-patch.patch">the patch</a> to get reviewed on the ffmpeg-devel mailing list.</p>

<p>EDIT: Turns out my patch was <a href="http://git.videolan.org/?p=ffmpeg.git;a=commit;h=87dc8b3af9135f0cfcdf3c0520e3f29e7b0d92c6">merged 3 days prior to this post</a>, and I didn't notice since my tiny brain couldn't handle the concept of a mailing list.</p>
<p><a href="blog_2014-08-11_20-30-41.html">Permalink</a></p>
</div>
<div class="blogpost">
<h2>2014/08/01 19:32:05</h2>

<p>I've been a little inactive for the past week. I lost my internet connection for a few days, so I got into playing some single-player games in my free time instead of working. However, I think I'm ready to get back into the swing of things. Today, I <a href="https://github.com/clintbellanger/flare-engine/issues/1134">outlined my idea</a> for a developer menu to add to Flare. I think it will make creating and iterating on the Empyrean campaign easier once it's implemented.</p>
<p><a href="blog_2014-08-01_19-32-05.html">Permalink</a></p>
</div>
<p>
<a href="blog_page0.html">Newer entries</a>
 | 
<a href="blog_page2.html">Older entries</a>
</p>

</div>

<div class="footer">
<hr/>
<p>
©2013-2015 Justin Jacobs.<br/>
This page uses valid <a href="http://jigsaw.w3.org/css-validator/check/referer">CSS 2.1</a> and <a href="http://validator.w3.org/check?uri=referer">XHTML 1.0 Strict</a>.
</p>
</div>

</body>

</html>
